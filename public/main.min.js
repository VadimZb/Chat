"use strict";var socket=io(),$messages=document.querySelector("#messages"),$inputField=document.querySelector("#inputField"),$username=document.querySelector("#username"),$online=document.querySelector("#online");window.addEventListener("keypress",(function(e){"Enter"===e.key&&sendMessage()})),console.log("%cGitHub Repo","display: inline-block ; background-color: gold ; color: black ; font-weight: bold ; padding: 3px 7px 3px 7px ; border-radius: 3px 3px 3px 3px ;"),console.log("%chttps://github.com/VadimZb/Chat","font-weight: bold; color: #007bff;");var lastUser="";function generateMessage(e,t,a){function s(e){var t=document.createElement("span");t.classList.add("big");return new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/).test(e)?t.appendChild(function(e){var t=document.createElement("a");return t.setAttribute("href",e),t.setAttribute("target","_blank"),t.classList.add("a","bold"),t.textContent=e,t}(e)):t.textContent=e,t}function n(e){var t=document.createElement("i");if("io"===e)t.classList.add("fas","fa-user");else if("socket"===e)t.classList.add("far","fa-user");else{if("system"!==e)throw Error("Wrong type provided");t.classList.add("far","fa-bell")}return t}function r(e,t,a){var s=document.createElement("div");return"text"===t?(s.classList.add("padding"),a&&s.classList.add("border-top"),"socket"===e?s.classList.add("lightest-green-bg"):s.classList.add("lightest-bg")):"info"===t&&s.classList.add("margin-horizontal","margin-vertical"),s}return"system"===e?function(e,t){var a=document.createElement("span");a.classList.add("gray","space-left","nocopy"),a.textContent=e+" "+t;var s=n("system"),r=document.createElement("li");r.classList.add("margin-vertical","margin-horizontal","padding","align-center","animated");for(var l=[s,a],i=0;i<l.length;i++){var o=l[i];r.appendChild(o)}return r}(t,a):function(e,t,a){var l=document.createElement("li");if(t===lastUser){var i=s(a),o=r(e,"text");o.appendChild(i),l.appendChild(o),l.classList.add("margin-vertical","margin-horizontal","border","animated"),"io"===e?l.classList.add("lightest-bg"):l.classList.add("lightest-green-bg")}else{for(var d=n(e),c=function(e){var t=document.createElement("span");return t.classList.add("bold","big","space-left"),t.textContent=e,t}(t),u=s(a),g=function(){var e=document.createElement("span"),t=new Date,a=t.getHours(),s=t.getMinutes();a<10&&(a="0"+a),s<10&&(s="0"+s);var n=a+":"+s;return e.textContent=n,e.classList.add("gray","small","space-left","nocopy"),e}(),m=r(e,"info"),p=r(e,"text"),f=[d,c,g],v=0;v<f.length;v++){var h=f[v];m.appendChild(h)}p.appendChild(u);for(var b=[m,p],y=0;y<b.length;y++){var $=b[y];l.appendChild($)}l.classList.add("margin-vertical","margin-horizontal","border","animated"),"io"===e?l.classList.add("light-bg"):l.classList.add("light-green-bg")}return lastUser=t,l}(e,t,a)}function enterChat(){if($username.value.replace(/\s/g,"").length)if($username.value.length>20)alert("Username should less than 20 characters."),$username.focus();else if(usersArray.includes($username.value))alert("Username is taken"),$username.focus();else{var e=document.getElementById("name"),t=document.getElementById("chat");document.getElementById("header");document.getElementById("info").textContent=$username.value,socket.emit("name given",$username.value),e.style.display="none",t.style.display="flex"}else $username.value="",$username.focus()}function addMessage(e){$messages.appendChild(e),$messages.scrollTop=$messages.scrollHeight}function sendMessage(){$inputField.value.replace(/\s/g,"").length?(addMessage(generateMessage("socket",$username.value,$inputField.value)),socket.emit("message sent",$username.value,$inputField.value),$inputField.value=""):$inputField.value="";$inputField.focus()}socket.on("user joined",(function(e){addMessage(generateMessage("system",e,"joined"))})),socket.on("user left",(function(e){addMessage(generateMessage("system",e,"left"))})),socket.on("new message",(function(e,t){addMessage(generateMessage("io",e,t))})),socket.on("refresh online",(function(e){$online.textContent=e}));var usersArray=[];socket.on("send blacklist",(function(e){usersArray=e}));
